generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Product {
  product_id   Int     @id @default(autoincrement()) 
  name         String
  description  String?
  price        Float
  stock        Int
  image_url    String?
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt

  order_items  OrderItem[]
}

model Order {
  order_id     Int      @id @default(autoincrement())  
  customer_id  Int  
  order_date   DateTime @default(now())
  total_amount Float
  status       OrderStatus @default(PENDING)   

  order_items  OrderItem[]
  tracking     Tracking?

  // Relation to Customer, if needed
  // customer     Customer @relation(fields: [customer_id], references: [id]) 
}

model OrderItem {
  order_item_id  Int      @id @default(autoincrement())  
  order_id       Int
  product_id     Int      
  quantity       Int
  price_per_unit Float

  order         Order   @relation(fields: [order_id], references: [order_id], onDelete: Cascade)
  product       Product @relation(fields: [product_id], references: [product_id], onDelete: Cascade)
}

model Tracking {
  tracking_id     Int      @id @default(autoincrement())  
  order_id        Int      @unique
  latitude        Float
  longitude       Float
  tracking_status TrackingStatus @default(IN_TRANSIT)
  last_update     DateTime @updatedAt

  order           Order    @relation(fields: [order_id], references: [order_id], onDelete: Cascade)
}

enum TrackingStatus {
  IN_TRANSIT
  DELIVERED
  CANCELLED
}

enum OrderStatus {
  PENDING
  SHIPPED
  COMPLETED
  CANCELLED
}
